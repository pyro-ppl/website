<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; Pyro Tutorials 1.8.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/pyro.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="svi_part_i.html" />
    <link rel="prev" title="&lt;no title&gt;" href="intro_long.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/pyro_logo_wide.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.8.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Practical Pyro and PyTorch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="svi_horovod.html">Example: distributed training via Horovod</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deep Generative Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cevae.html">Example: Causal Effect VAE</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse_gamma.html">Example: Sparse Gamma Deep Exponential Family</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Discrete Latent Variables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="toy_mixture_model_discrete_enumeration.html">Example: Toy Mixture Model With Discrete Enumeration</a></li>
<li class="toctree-l1"><a class="reference internal" href="hmm.html">Example: Hidden Markov Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="capture_recapture.html">Example: Capture-Recapture Models (CJS Models)</a></li>
<li class="toctree-l1"><a class="reference internal" href="mixed_hmm.html">Example: hierarchical mixed-effect hidden Markov models</a></li>
<li class="toctree-l1"><a class="reference internal" href="einsum.html">Example: Discrete Factor Graph Inference with Plated Einsum</a></li>
<li class="toctree-l1"><a class="reference internal" href="lda.html">Example: Amortized Latent Dirichlet Allocation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Customizing Inference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="neutra.html">Example: Neural MCMC with NeuTraReparam</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse_regression.html">Example: Sparse Bayesian Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="autoname_examples.html">Example: reducing boilerplate with <code class="docutils literal notranslate"><span class="pre">pyro.contrib.autoname</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Application: Time Series</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="forecast_simple.html">Multivariate Forecasting</a></li>
<li class="toctree-l1"><a class="reference internal" href="timeseries.html">Example: Gaussian Process Time Series Models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Application: Gaussian Processes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dkl.html">Example: Deep Kernel Learning</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Application: Epidemiology</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="epi_sir.html">Example: Univariate epidemiological models</a></li>
<li class="toctree-l1"><a class="reference internal" href="epi_regional.html">Example: Regional epidemiological models</a></li>
<li class="toctree-l1"><a class="reference internal" href="sir_hmc.html">Example: Epidemiological inference via HMC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Application: Biological sequences</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mue_profile.html">Example: Constant + MuE (Profile HMM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="mue_factor.html">Example: Probabilistic PCA + MuE (FactorMuE)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Inference Algorithms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="baseball.html">Example: analyzing baseball stats with MCMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="mcmc.html">Example: Inference with Markov Chain Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="lkj.html">Example: MCMC with an LKJ prior over covariances</a></li>
<li class="toctree-l1"><a class="reference internal" href="smcfilter.html">Example: Sequential Monte Carlo Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="inclined_plane.html">Example: importance sampling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Understanding Pyro's Internals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="minipyro.html">Mini-Pyro</a></li>
<li class="toctree-l1"><a class="reference internal" href="hmm_funsor.html">Example: hidden Markov models with <code class="docutils literal notranslate"><span class="pre">pyro.contrib.funsor</span></code> and <code class="docutils literal notranslate"><span class="pre">pyroapi</span></code></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyro Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/model_rendering.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<dl>
<dt>{</dt><dd><dl>
<dt>“cells”: [</dt><dd><dl>
<dt>{</dt><dd><p>“cell_type”: “markdown”,
“id”: “857effec”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“# Automatic rendering of Pyro modelsn”,
“n”,
“In this tutorial we will demonstrate how to create beautiful visualizations of your probabilistic graphical models using [pyro.render_model()](<a class="reference external" href="https://docs.pyro.ai/en/latest/infer.util.html#pyro.infer.inspect.render_model">https://docs.pyro.ai/en/latest/infer.util.html#pyro.infer.inspect.render_model</a>).”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 22,
“id”: “8a068eb0”,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“import osn”,
“import torchn”,
“import torch.nn.functional as Fn”,
“import pyron”,
“import pyro.distributions as distn”,
“import pyro.distributions.constraints as constraintsn”,
“n”,
“smoke_test = (‘CI’ in os.environ)n”,
“assert pyro.__version__.startswith(‘1.8.1’)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“id”: “d1266c17”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“## A Simple Examplen”,
“n”,
“The visualization interface can be readily used with your models:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 23,
“id”: “855a7d8f”,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“def model(data):n”,
”    m = pyro.sample(&quot;m&quot;, dist.Normal(0, 1))n”,
”    sd = pyro.sample(&quot;sd&quot;, dist.LogNormal(m, 1))n”,
”    with pyro.plate(&quot;N&quot;, len(data)):n”,
”        pyro.sample(&quot;obs&quot;, dist.Normal(m, sd), obs=data)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 24,
“id”: “e1e9628e”,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“image/svg+xml”: [</dt><dd><p>“&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;n”,
“&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot;n”,
” &quot;<a class="reference external" href="http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd</a>&quot;&gt;n”,
“&lt;!– Generated by graphviz version 2.40.1 (20161225.0304)n”,
” –&gt;n”,
“&lt;!– Title: %3 Pages: 1 –&gt;n”,
“&lt;svg width=&quot;105pt&quot; height=&quot;227pt&quot;n”,
” viewBox=&quot;0.00 0.00 105.00 227.00&quot; xmlns=&quot;<a class="reference external" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;n”,
“&lt;g id=&quot;graph0&quot; class=&quot;graph&quot; transform=&quot;scale(1 1) rotate(0) translate(4 223)&quot;&gt;n”,
“&lt;title&gt;%3&lt;/title&gt;n”,
“&lt;polygon fill=&quot;#ffffff&quot; stroke=&quot;transparent&quot; points=&quot;-4,4 -4,-223 101,-223 101,4 -4,4&quot;/&gt;n”,
“&lt;g id=&quot;clust1&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_N&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;19,-8 19,-83 89,-83 89,-8 19,-8&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;76&quot; y=&quot;-15.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;N&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– m –&gt;n”,
“&lt;g id=&quot;node1&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;m&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;54&quot; cy=&quot;-201&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;54&quot; y=&quot;-197.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;m&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– sd –&gt;n”,
“&lt;g id=&quot;node2&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;sd&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;27&quot; cy=&quot;-129&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;27&quot; y=&quot;-125.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;sd&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– m-&amp;gt;sd –&gt;n”,
“&lt;g id=&quot;edge1&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;m-&amp;gt;sd&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M47.3258,-183.2022C44.2524,-175.0064 40.5384,-165.1024 37.1305,-156.0145&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;40.3858,-154.7274 33.5974,-146.593 33.8315,-157.1853 40.3858,-154.7274&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– obs –&gt;n”,
“&lt;g id=&quot;node3&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;obs&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#c0c0c0&quot; stroke=&quot;#000000&quot; cx=&quot;54&quot; cy=&quot;-57&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;54&quot; y=&quot;-53.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;obs&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– m-&amp;gt;obs –&gt;n”,
“&lt;g id=&quot;edge3&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;m-&amp;gt;obs&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M57.7474,-183.0931C59.7466,-172.6241 61.9966,-159.1241 63,-147 64.3197,-131.0545 64.3197,-126.9455 63,-111 62.2945,-102.4753 60.9727,-93.2703 59.5551,-84.917&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;62.9689,-84.1258 57.7474,-74.9069 56.0803,-85.3698 62.9689,-84.1258&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– sd-&amp;gt;obs –&gt;n”,
“&lt;g id=&quot;edge2&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;sd-&amp;gt;obs&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M33.6742,-111.2022C36.7476,-103.0064 40.4616,-93.1024 43.8695,-84.0145&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;47.1685,-85.1853 47.4026,-74.593 40.6142,-82.7274 47.1685,-85.1853&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;/g&gt;n”,
“&lt;/svg&gt;n”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>“&lt;graphviz.graphs.Digraph at 0x7f55785408e0&gt;”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 24,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“data = torch.ones(10)n”,
“pyro.render_model(model, model_args=(data,))”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“id”: “eb1f65be”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“The visualization can be saved to a file by providing <cite>filename=’path’</cite> to <cite>pyro.render_model</cite>. You can use different formats such as PDF or PNG by changing the filename’s suffix.n”,
“When not saving to a file (<cite>filename=None</cite>), you can also change the format with <cite>graph.format = ‘pdf’</cite> where <cite>graph</cite> is the object returned by <cite>pyro.render_model</cite>.”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 25,
“id”: “700a0917”,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“graph = pyro.render_model(model, model_args=(data,), filename=&quot;model.pdf&quot;)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“id”: “3a4ea614”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“## Tweaking the visualizationn”,
“n”,
“As <cite>pyro.render_model</cite> returns an object of type <cite>graphviz.dot.Digraph</cite>, you can further improve the visualization of this graph.n”,
“For example, you could use the [unflatten preprocessor](<a class="reference external" href="https://graphviz.readthedocs.io/en/stable/api.html#graphviz.unflatten">https://graphviz.readthedocs.io/en/stable/api.html#graphviz.unflatten</a>) to improve the layout aspect ratio for more complex models.”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 26,
“id”: “01a4b74b”,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“def mace(positions, annotations):n”,
”    &quot;&quot;&quot;n”,
”    This model corresponds to the plate diagram in Figure 3 of <a class="reference external" href="https://www.aclweb.org/anthology/Q18-1040.pdf.n">https://www.aclweb.org/anthology/Q18-1040.pdf.n</a>”,
”    &quot;&quot;&quot;n”,
”    num_annotators = int(torch.max(positions)) + 1n”,
”    num_classes = int(torch.max(annotations)) + 1n”,
”    num_items, num_positions = annotations.shapen”,
“n”,
”    with pyro.plate(&quot;annotator&quot;, num_annotators):n”,
”        epsilon = pyro.sample(&quot;ε&quot;, dist.Dirichlet(torch.full((num_classes,), 10.)))n”,
”        theta = pyro.sample(&quot;θ&quot;, dist.Beta(0.5, 0.5))n”,
“n”,
”    with pyro.plate(&quot;item&quot;, num_items, dim=-2):n”,
”        # NB: using constant logits for discrete uniform priorn”,
”        # (NumPyro does not have DiscreteUniform distribution yet)n”,
”        c = pyro.sample(&quot;c&quot;, dist.Categorical(logits=torch.zeros(num_classes)))n”,
“n”,
”        with pyro.plate(&quot;position&quot;, num_positions):n”,
”            s = pyro.sample(&quot;s&quot;, dist.Bernoulli(1 - theta[positions]))n”,
”            probs = torch.where(n”,
”                s[…, None] == 0, F.one_hot(c, num_classes).float(), epsilon[positions]n”,
”            )n”,
”            pyro.sample(&quot;y&quot;, dist.Categorical(probs), obs=annotations)n”,
“n”,
“n”,
“positions = torch.tensor([1, 1, 1, 2, 3, 4, 5])n”,
“# fmt: offn”,
“annotations = torch.tensor([n”,
”    [1, 3, 1, 2, 2, 2, 1, 3, 2, 2, 4, 2, 1, 2, 1,n”,
”     1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 2, 1, 1, 1,n”,
”     1, 3, 1, 2, 2, 4, 2, 2, 3, 1, 1, 1, 2, 1, 2],n”,
”    [1, 3, 1, 2, 2, 2, 2, 3, 2, 3, 4, 2, 1, 2, 2,n”,
”     1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 3, 1, 1, 1,n”,
”     1, 3, 1, 2, 2, 3, 2, 3, 3, 1, 1, 2, 3, 2, 2],n”,
”    [1, 3, 2, 2, 2, 2, 2, 3, 2, 2, 4, 2, 1, 2, 1,n”,
”     1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 2, 1, 1, 2,n”,
”     1, 3, 1, 2, 2, 3, 1, 2, 3, 1, 1, 1, 2, 1, 2],n”,
”    [1, 4, 2, 3, 3, 3, 2, 3, 2, 2, 4, 3, 1, 3, 1,n”,
”     2, 1, 1, 2, 1, 2, 2, 3, 2, 1, 1, 2, 1, 1, 1,n”,
”     1, 3, 1, 2, 3, 4, 2, 3, 3, 1, 1, 2, 2, 1, 2],n”,
”    [1, 3, 1, 1, 2, 3, 1, 4, 2, 2, 4, 3, 1, 2, 1,n”,
”     1, 1, 1, 2, 3, 2, 2, 2, 2, 1, 1, 2, 1, 1, 1,n”,
”     1, 2, 1, 2, 2, 3, 2, 2, 4, 1, 1, 1, 2, 1, 2],n”,
”    [1, 3, 2, 2, 2, 2, 1, 3, 2, 2, 4, 4, 1, 1, 1,n”,
”     1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 2, 1, 1, 2,n”,
”     1, 3, 1, 2, 3, 4, 3, 3, 3, 1, 1, 1, 2, 1, 2],n”,
”    [1, 4, 2, 1, 2, 2, 1, 3, 3, 3, 4, 3, 1, 2, 1,n”,
”     1, 1, 1, 1, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1, 1,n”,
”     1, 3, 1, 2, 2, 3, 2, 3, 2, 1, 1, 1, 2, 1, 2],n”,
“]).Tn”,
“# fmt: onn”,
“n”,
“# we subtract 1 because the first index starts with 0 in Pythonn”,
“positions -= 1n”,
“annotations -= 1n”,
“n”,
“mace_graph = pyro.render_model(mace, model_args=(positions, annotations))”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 27,
“id”: “311896af”,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“image/svg+xml”: [</dt><dd><p>“&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;n”,
“&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot;n”,
” &quot;<a class="reference external" href="http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd</a>&quot;&gt;n”,
“&lt;!– Generated by graphviz version 2.40.1 (20161225.0304)n”,
” –&gt;n”,
“&lt;!– Title: %3 Pages: 1 –&gt;n”,
“&lt;svg width=&quot;201pt&quot; height=&quot;293pt&quot;n”,
” viewBox=&quot;0.00 0.00 201.00 293.00&quot; xmlns=&quot;<a class="reference external" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;n”,
“&lt;g id=&quot;graph0&quot; class=&quot;graph&quot; transform=&quot;scale(1 1) rotate(0) translate(4 289)&quot;&gt;n”,
“&lt;title&gt;%3&lt;/title&gt;n”,
“&lt;polygon fill=&quot;#ffffff&quot; stroke=&quot;transparent&quot; points=&quot;-4,4 -4,-289 197,-289 197,4 -4,4&quot;/&gt;n”,
“&lt;g id=&quot;clust1&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_annotator&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;8,-202 8,-277 150,-277 150,-202 8,-202&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;116&quot; y=&quot;-209.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;annotator&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;g id=&quot;clust2&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_item&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;35,-8 35,-194 185,-194 185,-8 35,-8&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;164.5&quot; y=&quot;-15.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;item&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;g id=&quot;clust3&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_position&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;107,-39 107,-186 177,-186 177,-39 107,-39&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;147&quot; y=&quot;-46.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;position&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– ε –&gt;n”,
“&lt;g id=&quot;node1&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;ε&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;43&quot; cy=&quot;-251&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;43&quot; y=&quot;-247.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;ε&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– y –&gt;n”,
“&lt;g id=&quot;node5&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;y&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#c0c0c0&quot; stroke=&quot;#000000&quot; cx=&quot;142&quot; cy=&quot;-88&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;142&quot; y=&quot;-84.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;y&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– ε-&amp;gt;y –&gt;n”,
“&lt;g id=&quot;edge3&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;ε-&amp;gt;y&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M34.8494,-233.6516C25.4263,-210.8095 13.3308,-170.245 31,-142 47.2544,-116.0167 79.9901,-102.2116 105.7196,-95.0872&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;106.7112,-98.4465 115.5405,-92.5904 104.9864,-91.6624 106.7112,-98.4465&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– θ –&gt;n”,
“&lt;g id=&quot;node2&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;θ&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;115&quot; cy=&quot;-251&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;115&quot; y=&quot;-247.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;θ&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– s –&gt;n”,
“&lt;g id=&quot;node4&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;s&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;142&quot; cy=&quot;-160&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;142&quot; y=&quot;-156.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;s&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– θ-&amp;gt;s –&gt;n”,
“&lt;g id=&quot;edge1&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;θ-&amp;gt;s&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M120.3343,-233.0213C124.1803,-220.0591 129.4425,-202.3234 133.8177,-187.5772&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;137.1876,-188.5238 136.6768,-177.9413 130.4768,-186.5327 137.1876,-188.5238&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– c –&gt;n”,
“&lt;g id=&quot;node3&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;c&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;70&quot; cy=&quot;-160&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;70&quot; y=&quot;-156.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;c&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– c-&amp;gt;y –&gt;n”,
“&lt;g id=&quot;edge2&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;c-&amp;gt;y&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M85.2693,-144.7307C95.197,-134.803 108.3153,-121.6847 119.4363,-110.5637&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;122.1564,-112.7933 126.7527,-103.2473 117.2067,-107.8436 122.1564,-112.7933&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– s-&amp;gt;y –&gt;n”,
“&lt;g id=&quot;edge4&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;s-&amp;gt;y&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M142,-141.8314C142,-134.131 142,-124.9743 142,-116.4166&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;145.5001,-116.4132 142,-106.4133 138.5001,-116.4133 145.5001,-116.4132&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;/g&gt;n”,
“&lt;/svg&gt;n”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>“&lt;graphviz.graphs.Digraph at 0x7f549e7035e0&gt;”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 27,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“# default layoutn”,
“mace_graph”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 28,
“id”: “8babebb4”,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“image/svg+xml”: [</dt><dd><p>“&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;n”,
“&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot;n”,
” &quot;<a class="reference external" href="http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd</a>&quot;&gt;n”,
“&lt;!– Generated by graphviz version 2.40.1 (20161225.0304)n”,
” –&gt;n”,
“&lt;!– Title: %3 Pages: 1 –&gt;n”,
“&lt;svg width=&quot;272pt&quot; height=&quot;285pt&quot;n”,
” viewBox=&quot;0.00 0.00 272.00 285.00&quot; xmlns=&quot;<a class="reference external" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;n”,
“&lt;g id=&quot;graph0&quot; class=&quot;graph&quot; transform=&quot;scale(1 1) rotate(0) translate(4 281)&quot;&gt;n”,
“&lt;title&gt;%3&lt;/title&gt;n”,
“&lt;polygon fill=&quot;#ffffff&quot; stroke=&quot;transparent&quot; points=&quot;-4,4 -4,-281 268,-281 268,4 -4,4&quot;/&gt;n”,
“&lt;g id=&quot;clust1&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_annotator&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;8,-194 8,-269 150,-269 150,-194 8,-194&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;116&quot; y=&quot;-201.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;annotator&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;g id=&quot;clust2&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_item&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;158,-8 158,-269 256,-269 256,-8 158,-8&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;235.5&quot; y=&quot;-15.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;item&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;g id=&quot;clust3&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_position&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;166,-39 166,-186 236,-186 236,-39 166,-39&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;206&quot; y=&quot;-46.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;position&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– ε –&gt;n”,
“&lt;g id=&quot;node1&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;ε&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;43&quot; cy=&quot;-243&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;43&quot; y=&quot;-239.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;ε&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– y –&gt;n”,
“&lt;g id=&quot;node4&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;y&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#c0c0c0&quot; stroke=&quot;#000000&quot; cx=&quot;201&quot; cy=&quot;-88&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;201&quot; y=&quot;-84.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;y&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– ε-&amp;gt;y –&gt;n”,
“&lt;g id=&quot;edge1&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;ε-&amp;gt;y&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M53.82,-226.4083C60.5627,-216.5699 69.7008,-204.0918 79,-194 109.2359,-161.187 148.9839,-128.2375 174.7593,-107.9828&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;177.1917,-110.5247 182.9309,-101.619 172.8906,-105.0019 177.1917,-110.5247&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– θ –&gt;n”,
“&lt;g id=&quot;node2&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;θ&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;115&quot; cy=&quot;-243&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;115&quot; y=&quot;-239.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;θ&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– s –&gt;n”,
“&lt;g id=&quot;node3&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;s&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;201&quot; cy=&quot;-160&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;201&quot; y=&quot;-156.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;s&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– θ-&amp;gt;s –&gt;n”,
“&lt;g id=&quot;edge2&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;θ-&amp;gt;s&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M126.281,-226.6249C133.5766,-216.6301 143.6211,-203.9122 154,-194 159.7081,-188.5485 166.3264,-183.2482 172.7625,-178.5175&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;175.1828,-181.0925 181.3236,-172.4588 171.139,-175.3786 175.1828,-181.0925&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– s-&amp;gt;y –&gt;n”,
“&lt;g id=&quot;edge4&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;s-&amp;gt;y&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M201,-141.8314C201,-134.131 201,-124.9743 201,-116.4166&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;204.5001,-116.4132 201,-106.4133 197.5001,-116.4133 204.5001,-116.4132&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– c –&gt;n”,
“&lt;g id=&quot;node5&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;c&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;221&quot; cy=&quot;-243&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;221&quot; y=&quot;-239.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;c&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– c-&amp;gt;y –&gt;n”,
“&lt;g id=&quot;edge3&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;c-&amp;gt;y&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M228.4359,-225.5206C236.0514,-205.1224 245.643,-170.5459 237,-142 233.7339,-131.2127 227.5236,-120.6108 221.1687,-111.6963&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;223.9513,-109.5732 215.1229,-103.7156 218.3715,-113.8001 223.9513,-109.5732&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;/g&gt;n”,
“&lt;/svg&gt;n”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>“&lt;graphviz.sources.Source at 0x7f5578547100&gt;”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 28,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“# layout after processing the layout with unflattenn”,
“mace_graph.unflatten(stagger=2)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“id”: “50a92902”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“## Rendering the parameters”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“id”: “74f32e20”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“We can render the parameters defined as <cite>pyro.param</cite> by setting <cite>render_params=True</cite> in <cite>pyro.render_model</cite>. “</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 29,
“id”: “645df936”,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“def model(data):n”,
”    sigma = pyro.param(&quot;sigma&quot;, torch.tensor([1.]), constraint=constraints.positive)n”,
”    mu = pyro.param(&quot;mu&quot;, torch.tensor([0.]))n”,
”    x = pyro.sample(&quot;x&quot;, dist.Normal(mu, sigma))n”,
”    y = pyro.sample(&quot;y&quot;, dist.LogNormal(x, 1))n”,
”    with pyro.plate(&quot;N&quot;, len(data)):n”,
”        pyro.sample(&quot;z&quot;, dist.Normal(x, y), obs=data)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 30,
“id”: “66fc9f55”,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“image/svg+xml”: [</dt><dd><p>“&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;n”,
“&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot;n”,
” &quot;<a class="reference external" href="http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd</a>&quot;&gt;n”,
“&lt;!– Generated by graphviz version 2.40.1 (20161225.0304)n”,
” –&gt;n”,
“&lt;!– Title: %3 Pages: 1 –&gt;n”,
“&lt;svg width=&quot;106pt&quot; height=&quot;278pt&quot;n”,
” viewBox=&quot;0.00 0.00 106.00 278.00&quot; xmlns=&quot;<a class="reference external" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;n”,
“&lt;g id=&quot;graph0&quot; class=&quot;graph&quot; transform=&quot;scale(1 1) rotate(0) translate(4 274)&quot;&gt;n”,
“&lt;title&gt;%3&lt;/title&gt;n”,
“&lt;polygon fill=&quot;#ffffff&quot; stroke=&quot;transparent&quot; points=&quot;-4,4 -4,-274 102,-274 102,4 -4,4&quot;/&gt;n”,
“&lt;g id=&quot;clust1&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_N&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;20,-8 20,-83 90,-83 90,-8 20,-8&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;77&quot; y=&quot;-15.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;N&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– x –&gt;n”,
“&lt;g id=&quot;node1&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;x&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;54&quot; cy=&quot;-201&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;54&quot; y=&quot;-197.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;x&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– y –&gt;n”,
“&lt;g id=&quot;node2&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;y&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;27&quot; cy=&quot;-129&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;27&quot; y=&quot;-125.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;y&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– x-&amp;gt;y –&gt;n”,
“&lt;g id=&quot;edge1&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;x-&amp;gt;y&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M47.3258,-183.2022C44.2524,-175.0064 40.5384,-165.1024 37.1305,-156.0145&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;40.3858,-154.7274 33.5974,-146.593 33.8315,-157.1853 40.3858,-154.7274&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– z –&gt;n”,
“&lt;g id=&quot;node5&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;z&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#c0c0c0&quot; stroke=&quot;#000000&quot; cx=&quot;55&quot; cy=&quot;-57&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;55&quot; y=&quot;-53.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;z&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– x-&amp;gt;z –&gt;n”,
“&lt;g id=&quot;edge2&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;x-&amp;gt;z&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M57.7474,-183.0931C59.7466,-172.6241 61.9966,-159.1241 63,-147 64.3197,-131.0545 64.1756,-126.9568 63,-111 62.3733,-102.4935 61.1985,-93.2939 59.9384,-84.9399&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;63.3718,-84.2455 58.3315,-74.9264 56.4602,-85.3546 63.3718,-84.2455&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– y-&amp;gt;z –&gt;n”,
“&lt;g id=&quot;edge3&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;y-&amp;gt;z&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M33.778,-111.5708C36.9872,-103.3187 40.8935,-93.2738 44.4758,-84.0623&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;47.8248,-85.1069 48.1874,-74.5182 41.3008,-82.5697 47.8248,-85.1069&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– mu –&gt;n”,
“&lt;g id=&quot;node3&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;mu&lt;/title&gt;n”,
“&lt;polygon fill=&quot;#ffffff&quot; stroke=&quot;transparent&quot; points=&quot;41.5,-270 22.5,-270 22.5,-255 41.5,-255 41.5,-270&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;32&quot; y=&quot;-258.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;mu&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– mu-&amp;gt;x –&gt;n”,
“&lt;g id=&quot;edge4&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;mu-&amp;gt;x&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M34.6976,-254.9589C37.1071,-248.2232 40.7873,-237.9355 44.2904,-228.1426&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;47.6082,-229.2592 47.6809,-218.6646 41.0172,-226.9014 47.6082,-229.2592&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– sigma –&gt;n”,
“&lt;g id=&quot;node4&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;sigma&lt;/title&gt;n”,
“&lt;polygon fill=&quot;#ffffff&quot; stroke=&quot;transparent&quot; points=&quot;94,-270 60,-270 60,-255 94,-255 94,-270&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;77&quot; y=&quot;-258.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;sigma&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– sigma-&amp;gt;x –&gt;n”,
“&lt;g id=&quot;edge5&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;sigma-&amp;gt;x&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M74.1797,-254.9589C71.6607,-248.2232 67.8133,-237.9355 64.1509,-228.1426&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;67.3875,-226.805 60.6063,-218.6646 60.831,-229.2571 67.3875,-226.805&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;/g&gt;n”,
“&lt;/svg&gt;n”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>“&lt;graphviz.graphs.Digraph at 0x7f549e7b0970&gt;”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 30,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“data = torch.ones(10)n”,
“pyro.render_model(model, model_args=(data,), render_params=True)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“id”: “f09e73e1”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“## Distribution and Constraint annotationsn”,
“n”,
“It is possible to display the distribution of each RV in the generated plot by providing <cite>render_distributions=True</cite> when calling <cite>pyro.render_model</cite>. The constraints associated with parameters are also displayed when <cite>render_distributions=True</cite>.”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 31,
“id”: “8130359c”,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“image/svg+xml”: [</dt><dd><p>“&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;n”,
“&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot;n”,
” &quot;<a class="reference external" href="http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd</a>&quot;&gt;n”,
“&lt;!– Generated by graphviz version 2.40.1 (20161225.0304)n”,
” –&gt;n”,
“&lt;!– Title: %3 Pages: 1 –&gt;n”,
“&lt;svg width=&quot;362pt&quot; height=&quot;346pt&quot;n”,
” viewBox=&quot;0.00 0.00 362.00 346.00&quot; xmlns=&quot;<a class="reference external" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;n”,
“&lt;g id=&quot;graph0&quot; class=&quot;graph&quot; transform=&quot;scale(1 1) rotate(0) translate(4 342)&quot;&gt;n”,
“&lt;title&gt;%3&lt;/title&gt;n”,
“&lt;polygon fill=&quot;#ffffff&quot; stroke=&quot;transparent&quot; points=&quot;-4,4 -4,-342 358,-342 358,4 -4,4&quot;/&gt;n”,
“&lt;g id=&quot;clust1&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_N&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;20,-8 20,-83 90,-83 90,-8 20,-8&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;77&quot; y=&quot;-15.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;N&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– x –&gt;n”,
“&lt;g id=&quot;node1&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;x&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;54&quot; cy=&quot;-201&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;54&quot; y=&quot;-197.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;x&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– y –&gt;n”,
“&lt;g id=&quot;node2&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;y&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;27&quot; cy=&quot;-129&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;27&quot; y=&quot;-125.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;y&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– x-&amp;gt;y –&gt;n”,
“&lt;g id=&quot;edge1&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;x-&amp;gt;y&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M47.3258,-183.2022C44.2524,-175.0064 40.5384,-165.1024 37.1305,-156.0145&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;40.3858,-154.7274 33.5974,-146.593 33.8315,-157.1853 40.3858,-154.7274&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– z –&gt;n”,
“&lt;g id=&quot;node5&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;z&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#c0c0c0&quot; stroke=&quot;#000000&quot; cx=&quot;55&quot; cy=&quot;-57&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;55&quot; y=&quot;-53.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;z&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– x-&amp;gt;z –&gt;n”,
“&lt;g id=&quot;edge2&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;x-&amp;gt;z&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M57.7474,-183.0931C59.7466,-172.6241 61.9966,-159.1241 63,-147 64.3197,-131.0545 64.1756,-126.9568 63,-111 62.3733,-102.4935 61.1985,-93.2939 59.9384,-84.9399&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;63.3718,-84.2455 58.3315,-74.9264 56.4602,-85.3546 63.3718,-84.2455&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– y-&amp;gt;z –&gt;n”,
“&lt;g id=&quot;edge3&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;y-&amp;gt;z&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M33.778,-111.5708C36.9872,-103.3187 40.8935,-93.2738 44.4758,-84.0623&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;47.8248,-85.1069 48.1874,-74.5182 41.3008,-82.5697 47.8248,-85.1069&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– mu –&gt;n”,
“&lt;g id=&quot;node3&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;mu&lt;/title&gt;n”,
“&lt;polygon fill=&quot;#ffffff&quot; stroke=&quot;transparent&quot; points=&quot;41.5,-304 22.5,-304 22.5,-289 41.5,-289 41.5,-304&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;32&quot; y=&quot;-292.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;mu&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– mu-&amp;gt;x –&gt;n”,
“&lt;g id=&quot;edge4&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;mu-&amp;gt;x&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M33.8004,-288.6848C36.7852,-275.7278 42.8976,-249.1945 47.6208,-228.6914&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;51.0398,-229.4408 49.8741,-218.9103 44.2185,-227.8693 51.0398,-229.4408&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– sigma –&gt;n”,
“&lt;g id=&quot;node4&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;sigma&lt;/title&gt;n”,
“&lt;polygon fill=&quot;#ffffff&quot; stroke=&quot;transparent&quot; points=&quot;94,-304 60,-304 60,-289 94,-289 94,-304&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;77&quot; y=&quot;-292.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;sigma&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– sigma-&amp;gt;x –&gt;n”,
“&lt;g id=&quot;edge5&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;sigma-&amp;gt;x&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M75.1178,-288.6848C71.9973,-275.7278 65.6071,-249.1945 60.6691,-228.6914&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;64.0577,-227.8128 58.3135,-218.9103 57.2523,-229.4518 64.0577,-227.8128&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– distribution_description_node –&gt;n”,
“&lt;g id=&quot;node6&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;distribution_description_node&lt;/title&gt;n”,
“&lt;text text-anchor=&quot;start&quot; x=&quot;120&quot; y=&quot;-322.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;x ~ Normal&lt;/text&gt;n”,
“&lt;text text-anchor=&quot;start&quot; x=&quot;120&quot; y=&quot;-307.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;y ~ LogNormal&lt;/text&gt;n”,
“&lt;text text-anchor=&quot;start&quot; x=&quot;120&quot; y=&quot;-292.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;z ~ Normal&lt;/text&gt;n”,
“&lt;text text-anchor=&quot;start&quot; x=&quot;120&quot; y=&quot;-277.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;sigma ∈ GreaterThan(lower_bound=0.0)&lt;/text&gt;n”,
“&lt;text text-anchor=&quot;start&quot; x=&quot;120&quot; y=&quot;-262.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;mu ∈ Real()&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;/g&gt;n”,
“&lt;/svg&gt;n”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>“&lt;graphviz.graphs.Digraph at 0x7f549e76adc0&gt;”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 31,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“data = torch.ones(10)n”,
“pyro.render_model(model, model_args=(data,), render_params=True ,render_distributions=True)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“id”: “3a1e4c4e”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“In the above plot <strong>‘~’</strong> denotes the distribution of RV and <strong>‘$\in$’</strong> denotes the constraint of parameter.”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“id”: “4dbe4925”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“## Overlapping non-nested platesn”,
“n”,
“Note that overlapping non-nested plates may be drawn as multiple rectangles.”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 32,
“id”: “9f1a4ebf”,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“def model():n”,
”    plate1 = pyro.plate(&quot;plate1&quot;, 2, dim=-2)n”,
”    plate2 = pyro.plate(&quot;plate2&quot;, 3, dim=-1)n”,
”    with plate1:n”,
”        x = pyro.sample(&quot;x&quot;, dist.Normal(0, 1))n”,
”    with plate1, plate2:n”,
”        y = pyro.sample(&quot;y&quot;, dist.Normal(x, 1))n”,
”    with plate2:n”,
”        pyro.sample(&quot;z&quot;, dist.Normal(y.sum(-2, True), 1), obs=torch.zeros(3))”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 33,
“id”: “8514d7df”,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“image/svg+xml”: [</dt><dd><p>“&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;n”,
“&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot;n”,
” &quot;<a class="reference external" href="http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd</a>&quot;&gt;n”,
“&lt;!– Generated by graphviz version 2.40.1 (20161225.0304)n”,
” –&gt;n”,
“&lt;!– Title: %3 Pages: 1 –&gt;n”,
“&lt;svg width=&quot;110pt&quot; height=&quot;285pt&quot;n”,
” viewBox=&quot;0.00 0.00 110.00 285.00&quot; xmlns=&quot;<a class="reference external" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;n”,
“&lt;g id=&quot;graph0&quot; class=&quot;graph&quot; transform=&quot;scale(1 1) rotate(0) translate(4 281)&quot;&gt;n”,
“&lt;title&gt;%3&lt;/title&gt;n”,
“&lt;polygon fill=&quot;#ffffff&quot; stroke=&quot;transparent&quot; points=&quot;-4,4 -4,-281 106,-281 106,4 -4,4&quot;/&gt;n”,
“&lt;g id=&quot;clust1&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_plate1&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;8,-91 8,-269 94,-269 94,-91 8,-91&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;69&quot; y=&quot;-98.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;plate1&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;g id=&quot;clust2&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_plate2&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;16,-122 16,-197 86,-197 86,-122 16,-122&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;61&quot; y=&quot;-129.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;plate2&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;g id=&quot;clust3&quot; class=&quot;cluster&quot;&gt;n”,
“&lt;title&gt;cluster_plate2__CLONE&lt;/title&gt;n”,
“&lt;polygon fill=&quot;none&quot; stroke=&quot;#000000&quot; points=&quot;16,-8 16,-83 86,-83 86,-8 16,-8&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;61&quot; y=&quot;-15.8&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;plate2&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– x –&gt;n”,
“&lt;g id=&quot;node1&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;x&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;51&quot; cy=&quot;-243&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;51&quot; y=&quot;-239.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;x&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– y –&gt;n”,
“&lt;g id=&quot;node2&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;y&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; cx=&quot;51&quot; cy=&quot;-171&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;51&quot; y=&quot;-167.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;y&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– x-&amp;gt;y –&gt;n”,
“&lt;g id=&quot;edge1&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;x-&amp;gt;y&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M51,-224.8314C51,-217.131 51,-207.9743 51,-199.4166&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;54.5001,-199.4132 51,-189.4133 47.5001,-199.4133 54.5001,-199.4132&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– z –&gt;n”,
“&lt;g id=&quot;node3&quot; class=&quot;node&quot;&gt;n”,
“&lt;title&gt;z&lt;/title&gt;n”,
“&lt;ellipse fill=&quot;#c0c0c0&quot; stroke=&quot;#000000&quot; cx=&quot;51&quot; cy=&quot;-57&quot; rx=&quot;27&quot; ry=&quot;18&quot;/&gt;n”,
“&lt;text text-anchor=&quot;middle&quot; x=&quot;51&quot; y=&quot;-53.3&quot; font-family=&quot;Times,serif&quot; font-size=&quot;14.00&quot; fill=&quot;#000000&quot;&gt;z&lt;/text&gt;n”,
“&lt;/g&gt;n”,
“&lt;!– y-&amp;gt;z –&gt;n”,
“&lt;g id=&quot;edge2&quot; class=&quot;edge&quot;&gt;n”,
“&lt;title&gt;y-&amp;gt;z&lt;/title&gt;n”,
“&lt;path fill=&quot;none&quot; stroke=&quot;#000000&quot; d=&quot;M51,-152.9364C51,-134.7827 51,-106.536 51,-85.3859&quot;/&gt;n”,
“&lt;polygon fill=&quot;#000000&quot; stroke=&quot;#000000&quot; points=&quot;54.5001,-85.3566 51,-75.3566 47.5001,-85.3567 54.5001,-85.3566&quot;/&gt;n”,
“&lt;/g&gt;n”,
“&lt;/g&gt;n”,
“&lt;/svg&gt;n”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>“&lt;graphviz.graphs.Digraph at 0x7f549e703a60&gt;”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 33,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“pyro.render_model(model)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>],
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“kernelspec”: {</dt><dd><p>“display_name”: “Python [conda env:root] <a href="#id1"><span class="problematic" id="id2">*</span></a>”,
“language”: “python”,
“name”: “conda-root-py”</p>
</dd>
</dl>
<p>},
“language_info”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“codemirror_mode”: {</dt><dd><p>“name”: “ipython”,
“version”: 3</p>
</dd>
</dl>
<p>},
“file_extension”: “.py”,
“mimetype”: “text/x-python”,
“name”: “python”,
“nbconvert_exporter”: “python”,
“pygments_lexer”: “ipython3”,
“version”: “3.9.7”</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
“nbformat”: 4,
“nbformat_minor”: 5</p>
</dd>
</dl>
<p>}</p>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="intro_long.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="svi_part_i.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Pyro Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>